#= require ../../content_assets/picker_view

Locomotive.Views.Inputs.Rte ||= {}

class Locomotive.Views.Inputs.Rte.FileView extends Backbone.View

  opened: false

  initialize: ->
    @$link      = $(@el)
    @editor     = @options.editor

  render: ->
    @attach_drawer()

    @show() # debug

  attach_drawer: ->
    command = @editor.toolbar.commandMapping['insertFile:null']
    command.dialog = @

    console.log "[insertFileView] attach_drawer"

  show: (state) ->
    console.log "[insertFileView] show #{state}"

    if state?
      console.log state
      console.log 'TODO popover'
    else
      window.application_view.drawer_view.open(@$link.data('url'), Locomotive.Views.ContentAssets.PickerView, @)
      @opened = true

  hide: ->
    console.log "[insertFileView] hide"
    if @opened
      window.application_view.drawer_view.close()
      @opened = false

  remove: ->
    console.log "[insertFileView] remove"
    super
